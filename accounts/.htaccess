# --- Folder listing pane ---
Options -Indexes

# --- Block direct access to the /security directory ---
<Directory "security">
    Require all denied
</Directory>

# --- Protect sensitive files at root /accounts/ ---
<FilesMatch "^(clean-logs\.php|log\.php)$">
    Require all denied
</FilesMatch>

# --- Header security against attacks ---
<IfModule mod_headers.c>
    # Prevent iframe embed
    Header always set X-Frame-Options "SAMEORIGIN"
    # Basic XSS Prevention
    Header set X-XSS-Protection "1; mode=block"
    # Prevent MIME sniffing
    Header set X-Content-Type-Options "nosniff"
</IfModule>

# --- Only allow PHP to run in the root directory and js/ ---
<FilesMatch "\.php$">
    Require all granted
</FilesMatch>

# --- Ngăn cache file nhạy cảm ---
<FilesMatch "\.(php)$">
    Header set Cache-Control "no-store, no-cache, must-revalidate"
</FilesMatch>
