RewriteEngine On
RewriteBase /make-market/

# Rules for specific endpoints
RewriteRule ^get-csrf$ process/get-csrf.php [L,NC]
RewriteRule ^get-tx/([0-9]+)$ process/get-tx.php?id=$1 [L,NC]
RewriteRule ^get-status/([0-9]+)$ process/get-status.php?id=$1 [L,NC]
RewriteRule ^swap$ process/swap.php [L,NC]
RewriteRule ^get-api$ process/get-api.php [L,NC]
RewriteRule ^get-decimals$ process/get-decimals.php [L,NC]
RewriteRule ^get-network$ process/get-network.php [L,NC]
RewriteRule ^create-tx/([0-9]+)$ process/create-tx.php?id=$1 [L,NC]
RewriteRule ^process/([0-9]+)$ process/process.php?id=$1 [L,NC]

# Prevent direct access to other PHP files in process directory
RewriteCond %{REQUEST_FILENAME} -f
RewriteCond %{REQUEST_FILENAME} \.php$
RewriteCond %{REQUEST_URI} !^/make-market/process/(process\.php|get-csrf\.php|get-tx\.php|get-status\.php|swap\.php|get-api\.php|get-decimals\.php|get-network\.php|create-tx\.php)
RewriteRule ^process/ - [F,L]

# Fallback to index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
